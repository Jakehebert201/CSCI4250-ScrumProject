<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <title>Database - Student Tracker</title>
</head>
<body class="layout">
  <nav class="site-nav">
    <a class="nav__item" href="{{ url_for('dashboard') }}">Dashboard</a>
    <a class="nav__item nav__item--active" href="{{ url_for('database') }}">Database</a>
    <a class="nav__item" href="{{ url_for('logout') }}">Logout</a>
  </nav>

  <main class="panel">
    <h1>Database â€” Users</h1>
    <table class="table">
      <thead>
        <tr><th>ID</th><th>Username</th><th>Email</th></tr>
      </thead>
      <tbody>
        {% for u in users %}
        <tr>
          <td>{{ u.id }}</td>
          <td>{{ u.username }}</td>
          <td>{{ u.email }}</td>
        </tr>
        {% else %}
        <tr><td colspan="3">No users found</td></tr>
        {% endfor %}
      </tbody>
    </table>

    <h2>Recent Locations</h2>
    <table class="table">
      <thead>
        <tr><th>#</th><th>User</th><th>Latitude</th><th>Longitude</th><th>City</th><th>Accuracy (m)</th><th>Recorded</th></tr>
      </thead>
      <tbody>
        {% for loc in locations %}
        <tr>
          <td>{{ loop.index }}</td>
          <td>{{ loc.user.username if loc.user else loc.user_id }}</td>
          <td>{{ "%.6f"|format(loc.lat) }}</td>
          <td>{{ "%.6f"|format(loc.lng) }}</td>
          <td>{{ loc.city or "-" }}</td>
          <td>{{ loc.accuracy or "-" }}</td>
          <td>{{ loc.created_at|format_dt }}</td>
        </tr>
        {% else %}
        <tr><td colspan="7">No locations recorded</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </main>
</body>
</html>