<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit {{ class_obj.full_course_name }} | Student Location Tracker</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body class="layout">
    <header class="page-header">
        <a class="brand" href="{{ url_for('main.landing_page') }}">Student Location Tracker</a>
        <nav class="page-nav">
            <a href="{{ url_for('main.professor_dashboard') }}" class="nav__item">Dashboard</a>
            <a href="/app/classes/" class="nav__item">My Classes</a>
            <a href="{{ url_for('main.database') }}" class="nav__item">Database</a>
            <a href="{{ url_for('auth.logout') }}" class="nav__item">Log Out</a>
        </nav>
    </header>
    
    <main class="login">
        <section class="login__panel" style="max-width: 600px;">
            <h1>Edit Class</h1>
            <p class="login__subtitle">Update the details for {{ class_obj.full_course_name }}.</p>
            
            {% with messages = get_flashed_messages() %}
                {% if messages %}
                    <div style="margin: 1rem 0;">
                        {% for message in messages %}
                            <p style="color: red; margin: 0.5rem 0;">{{ message }}</p>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}

            <form class="login__form" method="post" style="gap: 1.5rem;">
                <!-- Basic Information -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div>
                        <label for="course_code">Course Code *</label>
                        <input id="course_code" name="course_code" value="{{ class_obj.course_code }}" required>
                    </div>
                    <div>
                        <label for="section">Section</label>
                        <input id="section" name="section" value="{{ class_obj.section or '' }}">
                    </div>
                </div>

                <div>
                    <label for="course_name">Course Name *</label>
                    <input id="course_name" name="course_name" value="{{ class_obj.course_name }}" required>
                </div>

                <div>
                    <label for="description">Description</label>
                    <textarea id="description" name="description" rows="3" 
                              style="resize: vertical; font-family: inherit; padding: 0.75rem; border-radius: 10px; border: 1px solid rgba(30, 30, 36, 0.2);">{{ class_obj.description or '' }}</textarea>
                </div>

                <!-- Semester and Capacity -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                    <div>
                        <label for="semester">Semester *</label>
                        <select id="semester" name="semester" required>
                            <option value="Spring" {% if class_obj.semester == 'Spring' %}selected{% endif %}>Spring</option>
                            <option value="Summer" {% if class_obj.semester == 'Summer' %}selected{% endif %}>Summer</option>
                            <option value="Fall" {% if class_obj.semester == 'Fall' %}selected{% endif %}>Fall</option>
                            <option value="Winter" {% if class_obj.semester == 'Winter' %}selected{% endif %}>Winter</option>
                        </select>
                    </div>
                    <div>
                        <label for="year">Year *</label>
                        <input id="year" name="year" type="number" value="{{ class_obj.year }}" min="2024" max="2030" required>
                    </div>
                    <div>
                        <label for="credits">Credits</label>
                        <input id="credits" name="credits" type="number" value="{{ class_obj.credits }}" min="1" max="6">
                    </div>
                </div>

                <!-- Schedule Information -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                    <div>
                        <label for="meeting_days">Meeting Days</label>
                        <select id="meeting_days" name="meeting_days">
                            <option value="">Select Days</option>
                            <option value="MWF" {% if class_obj.meeting_days == 'MWF' %}selected{% endif %}>Monday, Wednesday, Friday</option>
                            <option value="TTH" {% if class_obj.meeting_days == 'TTH' %}selected{% endif %}>Tuesday, Thursday</option>
                            <option value="MW" {% if class_obj.meeting_days == 'MW' %}selected{% endif %}>Monday, Wednesday</option>
                            <option value="TH" {% if class_obj.meeting_days == 'TH' %}selected{% endif %}>Thursday</option>
                            <option value="F" {% if class_obj.meeting_days == 'F' %}selected{% endif %}>Friday</option>
                            <option value="MTWTHF" {% if class_obj.meeting_days == 'MTWTHF' %}selected{% endif %}>Monday - Friday</option>
                        </select>
                    </div>
                    <div>
                        <label for="start_time">Start Time</label>
                        <input id="start_time" name="start_time" type="time" 
                               value="{% if class_obj.start_time %}{{ class_obj.start_time.strftime('%H:%M') }}{% endif %}">
                    </div>
                    <div>
                        <label for="end_time">End Time</label>
                        <input id="end_time" name="end_time" type="time" 
                               value="{% if class_obj.end_time %}{{ class_obj.end_time.strftime('%H:%M') }}{% endif %}">
                    </div>
                </div>

                <!-- Location and Dates -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div>
                        <label for="room">Room</label>
                        <input id="room" name="room" value="{{ class_obj.room or '' }}">
                    </div>
                    <div>
                        <label for="capacity">Class Capacity</label>
                        <input id="capacity" name="capacity" type="number" value="{{ class_obj.capacity }}" min="1" max="200">
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div>
                        <label for="start_date">Start Date</label>
                        <input id="start_date" name="start_date" type="date" 
                               value="{% if class_obj.start_date %}{{ class_obj.start_date.strftime('%Y-%m-%d') }}{% endif %}">
                    </div>
                    <div>
                        <label for="end_date">End Date</label>
                        <input id="end_date" name="end_date" type="date" 
                               value="{% if class_obj.end_date %}{{ class_obj.end_date.strftime('%Y-%m-%d') }}{% endif %}">
                    </div>
                </div>

                <!-- Enrollment Settings -->
                <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: var(--muted); border-radius: 10px;">
                    <input type="checkbox" id="enrollment_open" name="enrollment_open" 
                           {% if class_obj.enrollment_open %}checked{% endif %}>
                    <label for="enrollment_open" style="margin: 0; cursor: pointer;">
                        <strong>Enrollment Open</strong> - Students can enroll in this class
                    </label>
                </div>

                <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                    <button type="submit" class="btn btn--primary" style="flex: 1;">
                        ✅ Update Class
                    </button>
                    <a href="{{ url_for('classes.view_class', class_id=class_obj.id) }}" class="btn btn--secondary">
                        ❌ Cancel
                    </a>
                </div>
            </form>
        </section>
    </main>
    
    <footer class="footer">
        <small>&copy; 2025 Student Tracker. Built with Flask.</small>
    </footer>
    <script src="{{ url_for('static', filename='js/theme-toggle.js') }}"></script>
</body>
</html>